// BEM-style block rules for Obtain Corn Hoop's Tumblr theme.
//
// Copyright (C) 2013 Damien Dart, <damiendart@pobox.com>.
// This file is distributed under the MIT licence. For more information,
// please refer to the accompanying "LICENCE" file.

@import "global-variables";
@import "glyphicons-halflings";
@import "mixins";
@import "bourbon";

/* a */.button {
  @include colour-swap-links(#ffffff, #000000);
  @include inline-block;
  border-radius: em($base-layout-unit, $base-font-size);
  font-weight: bold;
  padding: em($base-layout-unit / 2, $base-font-size)
      em($base-layout-unit, $base-font-size);
  text-transform: uppercase; }

// Don't use a "section" element, because semantics blah blah blah. See
// <http://html5doctor.com/the-section-element/> for more information.
/* div */.main-content {
  $width: 500px + ($base-layout-unit * 2);
  margin: em($base-layout-unit, $base-font-size) auto;
  width: em($width, $base-font-size);
  @media screen and (max-width: em($width, $base-font-size)) {
    margin: em($base-layout-unit / 2, $base-font-size) auto;
    width: 100%; }
  /* [Any block-level element] */.main-content__block {
    margin: em($base-layout-unit, $base-font-size) 0 0 0;
    @media screen and (max-width: em($width, $base-font-size)) {
      margin: em($base-layout-unit / 2, $base-font-size) 0 0 0;
      padding: 0 em($base-layout-unit / 2, $base-font-size); } } }

/* ul */.metadata-list {
  list-style: none;
  margin: 0;
  text-align: left;
  padding: 0;
  /* li */.metadata-list__item {
    &:before {
      // Adjust font size to make icon glyphs align better with adjacent text.
      $font-size: $base-font-size * 0.75;
      display: block;
      font-family: "Glyphicons Halflings";
      font-size: percentage($font-size / $base-font-size);
      height: em($base-line-height, $font-size);
      line-height: em($base-line-height, $font-size);
      speak: none; // TODO: Check whether this is necessary.
      width: em($base-line-height, $font-size); }
    /* div */.metadata-list__item__text {
      font-style: italic;
      margin: em($base-line-height * -1, $base-font-size) 0
          0 em($base-layout-unit, $base-font-size); } }
  @each $type in (("date", "\e023"), ("notes", "\e005"),
      ("source", "\e087"), ("tags", "\e042")) {
    /* li */.metadata-list__item--#{nth($type, 1)} {
      &:before {
        content: "#{nth($type, 2)}"; } } } }

/* ul */.navigation-list {
  list-style: none;
  // Apply negative margins to negate list items' "gutters".
  margin: em($base-layout-unit / -2, $base-font-size) 0
      0 em($base-layout-unit / -2, $base-font-size);
  padding-left: 0;
  /* li */.navigation-list__item {
    // Inline-block elements don't like whitespace between each other. See
    // <http://css-tricks.com/fighting-the-space-between-inline-block-elements/>
    // for more information.
    @include inline-block;
    margin: em($base-layout-unit / 2, $base-font-size) 0
        0 em($base-layout-unit / 2, $base-font-size); } }

// The markup of blogpost notes is generated by Tumblr and out of our
// control, hence the non-BEM-style class names and hacky (S)CSS.
/* ol */.notes {
  list-style: none;
  margin: 0;
  text-align: left;
  padding: 0;
  /* li */.note {
    margin: 0 0 0 em($base-layout-unit, $base-font-size);
    blockquote {
      display: inline;
      margin: 0; }
    /* span */.action {
      margin: 0 0 0 em($base-layout-unit * -1, $base-font-size); }
    /* a */.avatar_frame {
      cursor: default; // Hide the fact that this is a link.
      float: left;
      height: em($base-line-height, $base-font-size);
      left: em($base-line-height * -1, $base-font-size);
      // HACK AHOY. Using "pointer-events" to remove mouse events from the
      // HTML element has unintended side-effects. For more information, see
      // <http://css-tricks.com/pointer-events-current-nav/> and
      // <https://developer.mozilla.org/en-US/docs/CSS/pointer-events>.
      pointer-events: none; // Hide the fact that this is a link.
      position: relative;
      width: em($base-line-height, $base-font-size);
      /* img */.avatar {
        border: none;
        display: block;
        margin: -8px 0 0 0; // Assuming avatar images are 16px by 16px.
        opacity: 0.25; // Poor man's grey tint.
        position: relative;
        top: 50%; } }
    /* div */.clear {
      // This HTML element is unnecessary.
      display: none; } } }

/* ul */.pagination {
  @include clearfix;
  list-style: none;
  margin: 0;
  padding-left: 0;
  /* li */.pagination__previous {
    float: left; }
  /* li */.pagination__next {
    float: right; } }

/* section */.post-metadata {
  $background-colour: darken(#ffffff, 7.5);
  $foreground-colour: lighten(#000000, 70);
  background-color: $background-colour;
  border-radius: 0 0 em($base-layout-unit / 4, $base-font-size)
      em($base-layout-unit / 4, $base-font-size);
  color: $foreground-colour;
  padding: em($base-layout-unit / 2, $base-font-size)
      em($base-layout-unit, $base-font-size);
  a {
    @include colour-swap-links($background-colour, $foreground-colour); } }

/* section */.post-comments {
  $background-colour: darken(#ffffff, 7.5);
  $foreground-colour: lighten(#000000, 70);
  background-color: $background-colour;
  border-radius: 0 0 em($base-layout-unit / 4, $base-font-size)
      em($base-layout-unit / 4, $base-font-size);
  @each $prefix in ("", "-moz-", "-webkit-") {
    #{$prefix}box-shadow: inset 0
        em($base-layout-unit / 2, $base-font-size)
        em($base-layout-unit / 2, $base-font-size)
        em($base-layout-unit / -2, $base-font-size)
        darken($background-colour, 30); }
  color: $foreground-colour;
  margin: 0 em($base-layout-unit, $base-font-size);
  padding: em($base-layout-unit / 2, $base-font-size)
      em($base-layout-unit, $base-font-size);
  a {
    @include colour-swap-links($background-colour, $foreground-colour); } }

/* section */.post-body {
  $background-colour: #ffffff;
  $foreground-colour: #000000;
  background-color: $background-colour;
  border-radius: em($base-layout-unit / 4, $base-font-size);
  color: $foreground-colour;
  padding: em($base-layout-unit, $base-font-size);
  text-align: left;
  &:not(:only-child) {
    border-radius: em($base-layout-unit / 4, $base-font-size)
        em($base-layout-unit / 4, $base-font-size) 0 0; }
  a {
    @include colour-swap-links($background-colour, $foreground-colour); }
  blockquote {
    margin: em($base-line-height / 2, $base-font-size) 0 0 0;
    padding: 0 0 0 em($base-line-height, $base-font-size); }
  iframe, img {
    border-style: none; // Remove border on linked images.
    display: block;
    max-width: 100%;
    // FIXME: We shouldn't be applying this to every image and "iframe".
    @media screen and (max-width: em(500px, $base-font-size)) {
      margin: 0 0 0 em($base-layout-unit * -1, $base-font-size);
      @each $prefix in ("", "-moz-", "-webkit-") {
        max-width: #{$prefix}calc(100% +
            #{em($base-layout-unit * 2, $base-font-size)}); } } }
  h1 {
    $font-size: 24px;
    $line-height: 36px;
    font-size: percentage($font-size / $base-font-size);
    line-height: em($line-height, $font-size);
    margin: 0 0 em($base-line-height / 2, $font-size) 0; }
  p {
    margin: em($base-line-height / 2, $base-font-size) 0 0 0;
    &.quote-attribution {
      text-align: right;
      font-style: italic; }
    &:first-child {
      margin: 0; } }
  pre {
    margin: em($base-line-height / 2, $base-font-size) 0 0 0;
    overflow: auto; }
  ol, ul {
    list-style: square;
    margin: em($base-line-height / 2, $base-font-size) 0
        0 em($base-line-height, $base-font-size);
    padding: 0;
    & > * {
      margin: 0;
      padding: 0; } } }

/* header */.site-header {
  $foreground-colour: #ffffff;
  color: $foreground-colour;
  margin: em($base-layout-unit * 3, $base-font-size) auto;
  /* div */.site-header__title { }
  /* nav */.site-header__navigation { } }

/* h1 */.site-title {
  $font-size: 60px;
  $line-height: $font-size;
  font-size: percentage($font-size / $base-font-size);
  font-weight: normal;
  line-height: em($line-height, $font-size);
  margin: 0;
  @media screen and ($small-screen-breakpoint) {
    $font-size: 36px;
    $line-height: $font-size;
    font-size: percentage($font-size / $base-font-size);
    line-height: em($line-height, $font-size); }
  .site-title__link {
    $background-colour: transparent;
    $foreground-colour: #ffffff;
    background-color: $background-colour;
    color: $foreground-colour;
    text-decoration: none;
    &:active, &:focus, &:hover, &:visited, &:visited:hover {
      background-color: $background-colour;
      color: $foreground-colour; } } }

/* ul */.tag-list {
  display: inline;
  margin: 0;
  padding: 0;
  /* li */.tag-list__item {
    display: inline;
    &:before {
      content: ", "; }
    &:first-child:before {
      content: ""; } } }

/* div */.page-background {
  background: url("http://www.robotinaponcho.net/assets/blog-background.png")
      no-repeat center -150px;
  height: 505px;
  margin: 0 auto -505px auto;
  max-width: 100%;
  @media screen and (-webkit-min-device-pixel-ratio: 1.3) {
    background-image:
        url("http://www.robotinaponcho.net/assets/blog-background@2x.png");
    background-size: 800px 655px; } }

/* h2 */.page-title {
  $font-size: 30px;
  $line-height: 36px;
  font-size: percentage($font-size / $base-font-size);
  line-height: em($line-height, $font-size);
  margin: 0;
  text-align: center; }
