// Module rules for Obtain Corn Hoop.
//
// Copyright (C) 2013 Damien Dart, <damiendart@pobox.com>.
// This file is distributed under the MIT licence. For more information,
// please refer to the accompanying "LICENCE" file.

@import "mixins";
@import "variables";

.pager {
  .pager__pagerlist {
    @include reset-box-model;
    list-style: none;
    &:after {
      clear: both;
      content: "";
      display: table; }
    .pager__pagerlist__item {
      display: inline-block;
      .pager__pagerlist__item__button {
        @include colour-swap-links($post-background-colour,
            $post-foreground-colour);
        border-radius: $base-line-height;
        display: inline-block;
        font-weight: bold;
        padding: ($base-line-height / 2) $base-line-height; } }
        text-transform: uppercase;
    .pager__pagerlist__item--previouslink {
      float: left; }
    .pager__pagerlist__item--nextlink {
      float: right; } } }

.postmetadata {
  background-color: $post-background-colour;
  @each $prefix in ("", "-moz-", "-webkit-") {
    // In most browsers, the following declaration will produce a nine-pixel
    // shadow along the bottom edge of the element.
    #{$prefix}box-shadow: 0 ($base-line-height / 2) ($base-line-height * 0.375)
        ($base-line-height * -0.375) darken($page-background-colour, 30); }
  color: $post-metadata-foreground-colour;
  padding: 0 $base-line-height $base-line-height $base-line-height;
  a {
    @include colour-swap-links($post-background-colour,
        $post-metadata-foreground-colour); }
  .postmetadata__metadatalist {
    @include reset-box-model;
    list-style: none;
    text-align: left;
    .postmetadata__metadatalist__item {
      font-style: italic;
      margin: 0 0 0 $base-line-height;
      text-indent: $base-line-height * -1;
      &:before {
        float: left;
        font-family: "Glyphicons Halflings";
        font-size: $base-font-size * 0.75;
        height: $base-line-height / 0.75;
        // Tweak line-height so icons glyphs align better with adjacent text.
        // TODO: Test in non-iOS mobile browsers.
        line-height: ($base-line-height / 0.75) * 1.2;
        speak: none;
        width: $base-line-height / 0.75; } }
    @each $type in (("date", "\e023"), ("notes", "\e005"),
        ("source", "\e087"), ("tags", "\e042")) {
      .postmetadata__metadatalist__item--#{nth($type, 1)} {
        &:before {
          content: "#{nth($type, 2)}"; }
        @if (nth($type, 1) == "tags") {
          .postmetadata__metadatalist__item--tags__taglist {
            display: inline;
            padding: 0;
            .postmetadata__metadatalist__item--tags__taglist__item {
              display: inline;
              &:not(:last-child):after {
                content: ", "; } } } } } } } }

.postnotes {
  background-color: $post-background-colour;
  @each $prefix in ("", "-moz-", "-webkit-") {
    // In most browsers, the following will produce a 9-pixel shadow along the
    // bottom edge of the element, as well as inside on the top.
    #{$prefix}box-shadow: 0 ($base-line-height / 2) ($base-line-height * 0.375)
        ($base-line-height * -0.375) darken($page-background-colour, 30),
        inset 0 ($base-line-height / 2) ($base-line-height * 0.375)
        ($base-line-height * -0.375) darken($post-background-colour, 30); }
  color: $post-metadata-foreground-colour;
  margin: 0 $base-line-height;
  padding: ($base-line-height / 2) $base-line-height;
  .notes {
    @include reset-box-model;
    list-style: none;
    text-align: left;
    .note {
      margin: 0 0 0 $base-line-height;
      blockquote {
        display: inline;
        margin: 0; }
      .action {
        margin: 0 0 0 ($base-line-height * -1); }
      // TODO: Check if this works as intended in older browsers.
      .avatar_frame {
        float: left;
        height: $base-line-height;
        left: $base-line-height * -1;
        position: relative;
        opacity: 0.25; // Poor man's grey tint.
        width: $base-line-height;
        .avatar {
          margin: -8px 0 0 0; // Assuming avatar images are 16 by 16.
          position: relative;
          top: 50%; } }
      .clear {
        display: none; } } }
  a {
    @include colour-swap-links($post-background-colour,
        $post-metadata-foreground-colour); } }

.postbody {
  background-color: $post-background-colour;
  @each $prefix in ("", "-moz-", "-webkit-") {
    // In most browsers, the following will produce a 9-pixel shadow.
    #{$prefix}box-shadow: 0 ($base-line-height / 2) ($base-line-height * 0.375)
        ($base-line-height * -0.375) darken($page-background-colour, 30); }
  color: $post-foreground-colour;
  padding: $base-line-height;
  text-align: left;
  a {
    @include colour-swap-links($post-background-colour,
        $post-foreground-colour); }
  blockquote {
    margin: ($base-line-height / 2) 0 0 0;
    padding: 0 0 0 $base-line-height; }
  h1 {
    font-size: 150%;
    line-height: ($base-line-height / 1.5);
    margin: 0 0 ($base-line-height / 1.5) 0; }
  p {
    margin: ($base-line-height / 2) 0 0 0;
    &.quote-attribution {
      text-align: right;
      font-style: italic; }
    &:first-child {
      margin: 0; } }
  ol, ul {
    list-style: square;
    margin: ($base-line-height / 2) 0 0 $base-line-height;
    padding: 0;
    & > * {
      @include reset-box-model; } } }
