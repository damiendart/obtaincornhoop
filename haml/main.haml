-# Haml markup for Obtain Corn Hoop's Tumblr theme.
-#
-# Copyright (C) 2013 Damien Dart, <damiendart@pobox.com>.
-# This file is distributed under the MIT licence. For more information,
-# please refer to the accompanying "LICENCE" file.

-# A doctype declaration is unnecessary as Tumblr adds its own.
%html{:lang => "en"}
  %head
    %link{:href => "{RSS}", :rel => "alternate", :type => "application/rss+xml"}
    %link{:href => "{PortraitURL-128}", :rel => "apple-touch-icon"}
    %link{:href => "{Favicon}", :rel => "shortcut icon"}
    %link{:href => "http://www.robotinaponcho.net/assets/blog-style.css", :rel => "stylesheet"}
    %meta{:charset => "utf-8"}
    %tumblrblockDescription
      %meta{:content => "{MetaDescription}", :name => "description"}
    %meta{:content => "initial-scale=1.0,maximum-scale=1.0,user-scalable=no,width=device-width", :name => "viewport"}
    %script{:src => "//www.robotinaponcho.net/assets/html5shiv.js"}
    %script{:src => "//www.robotinaponcho.net/assets/selectnav.min.js"}
    %script{:src => "//use.typekit.com/gwe8uye.js"}
    -# HACK: Prevent "SelectNav.js" FOUC.
    %script document.documentElement.className += "js";
    %script try{Typekit.load();}catch(e){}
    %title<
      -# HACK: Haml doesn't like leaving trailing whitespace, so fudge things
      -# by using non-breaking spaces which get converted to regular spaces
      -# when everything is compiled.
      %tumblrblockDayPage> Posts From {DayOfMonth} {Month}, {Year} //&nbsp;
      %tumblrblockPostSummary> {PostSummary} //&nbsp;
      %tumblrblockSearchPage> Search Results For &ldquo;{SearchQuery}&rdquo; //&nbsp;
      %tumblrblockTagPage> Posts Tagged With &ldquo;{Tag}&rdquo; //&nbsp;
      {Title}
  %body
    .page-background
    %header.site-header
      .site-header__title
        %h1.site-title
          %a.site-title__link{:href => "/"} {Title}
      %nav.site-header__navigation
        %ul#selectnav.navigation-list
          %li.navigation-list__item>
            %a.button{:href => "/"} Home
          %li.navigation-list__item>
            %a.button{:href => "/archive"} Archives
          %li.navigation-list__item>
            %a.button{:href => "/about"} About
          %tumblrblockAskEnabled
            %li.navigation-list__item>
              %a.button{:href => "/ask"} Ask
    .main-content
      %tumblrblockDayPage
        .main-content__block
          %h2.page-title Posts from {DayOfMonth} {Month}, {Year}
      %tumblrblockTagPage
        .main-content__block
          %h2.page-title Posts Tagged With &ldquo;<i>{Tag}</i>&rdquo;
      %tumblrblockSearchPage
        .main-content__block
          %h2.page-title Search Results For &ldquo;<i>{SearchQuery}</i>&rdquo;
      %tumblrblockNoSearchResults
        %article.main-content__block
          %section.post-body
            %p Nothing :(
      %tumblrblockPosts
        %article.main-content__block
          %tumblrblockText
            %section.post-body
              %tumblrblockTitle
                %h1 {Title}
              {Body}
          %tumblrblockPhotoset
            %section.post-body
              \{Photoset-500}
              %tumblrblockCaption {Caption}
          %tumblrblockPhoto
            %section.post-body
              \{LinkOpenTag}
              %img.main{:alt => "{PhotoAlt}", :src => "{PhotoURL-500}"}>
              \{LinkCloseTag}
              %tumblrblockCaption {Caption}
          %tumblrblockQuote
            %section.post-body
              %p <q>{Quote}</q>
              %tumblrblockSource
                %p.quote-attribution &mdash; {Source}
          %tumblrblockAudio
            %section.post-body
              \{AudioEmbed-500}
              %tumblrblockCaption {Caption}
          %tumblrblockVideo
            %section.post-body
              \{Video-500}
              %tumblrblockCaption {Caption}
          %tumblrblockDate
            %section.post-metadata
              %ul.metadata-list
                %tumblrblockReblog
                  %li.metadata-list__item.metadata-list__item--date<
                    .metadata-list__item__text>
                      <a href="{Permalink}">Reblogged <span class="js-relative-date" data-relative-date="{TimeAgo}">on {Month} {DayOfMonth}, {Year}</span></a> from {ReblogParentName}
                %tumblrblockNotReblog
                  %li.metadata-list__item.metadata-list__item--date<
                    .metadata-list__item__text>
                      <a href="{Permalink}">Posted <span class="js-relative-date" data-relative-date="{TimeAgo}">on {Month} {DayofMonth}, {Year}</span></a>
                %tumblrblockContentSource
                  %li.metadata-list__item.metadata-list__item--source<
                    .metadata-list__item__text Source: <a href="{SourceURL}">{SourceTitle}</a>
                %tumblrblockHasTags
                  %li.metadata-list__item.metadata-list__item--tags<
                    .metadata-list__item__text
                      Tagged with:
                      %ul.tag-list
                        %tumblrblockTags
                          %li.tag-list__item<>
                            %a{:href => "{TagURL}"} {Tag}
                %tumblrblockIndexPage
                  %tumblrblockNoteCount
                    %li.metadata-list__item.metadata-list__item--notes<
                      .metadata-list__item__text This post has <a href="{Permalink}#notes">{NoteCountWithLabel}</a>
          %tumblrblockPostNotes
            %section.post-comments
              %a{:name => "notes"}
              {PostNotes}
      %tumblrblockPagination
        %nav.main-content__block
          %ul.pagination
            %tumblrblockPreviousPage
              %li.pagination__previous
                %a.button{:href => "{PreviousPage}"} Newer posts
            %tumblrblockNextPage
              %li.pagination__next
                %a.button{:href => "{NextPage}"} Older posts
      %tumblrblockDayPagination
        %nav.main-content__block
          %ul.pagination
            %tumblrblockPreviousDayPage
              %li.pagination__previous
                %a.button{:href => "{PreviousDayPage}"} {DayOfMonth} {Month}, {Year}
            %tumblrblockNextDayPage
              %li.pagination__next
                %a.button{:href => "{NextDayPage}"} {DayOfMonth} {Month}, {Year}
  :javascript
    selectnav("selectnav", { autoselect: false,
        label: "&#x2605;&#x2605;&#x2605; NAVIGATION &#x2605;&#x2605;&#x2605;" });
    if (navigator.appVersion.indexOf("Mac") == -1) {
      var site_title = document.getElementsByClassName("site-title");
      for (var i = 0; i < site_title.length; i++) {
        site_title[i].className += " js-site-title-windows-hack";
      }
    }
    var relative_dates = document.getElementsByClassName("js-relative-date");
    for (var i = 0; i < relative_dates.length; i++) {
      relative_dates[i].innerHTML =
          relative_dates[i].getAttribute("data-relative-date");
    }
